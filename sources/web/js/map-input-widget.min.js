function MapInputWidgetManager(){const t=".garixi-map-input-widget";var e=Array(),n=function(t){if(!$(t).data("initialized")){var e=new MapInputWidget(t);return e.initialize(),e}return null},a=function(t){var n=t.getId();e[n]=t};this.initializeWidgets=function(){$(t).each(function(t,e){var i=n(e);currWidget=i,i&&a(i)})},this.getWidget=function(t){var n=e[t];return n}}function MapInputWidget(t){const e="input.garixi-map-input-widget-input",n="div.garixi-map-input-widget-canvas";var a,i,o=this,r=function(){a=$(t).find(e).get(0),i=$(t).find(n).get(0)},u=function(){geocoder=new google.maps.Geocoder,map=new google.maps.Map(i,{mapTypeId:$(t).data("map-type"),center:m(),zoom:$(t).data("zoom"),styles:[{featureType:"poi",stylers:[{visibility:"off"}]}],mapTypeControlOptions:{mapTypeIds:[]}}),google.maps.event.addListener(map,"click",function(t){o.setPosition({latitude:t.latLng.lat(),longitude:t.latLng.lng()})})},d=function(){var e=s();o.setPosition(e),$(t).data("initialized",!0)},l=function(t){var e=c(),n=f(t);return e=e.replace(/%latitude%/g,n.lat()),e=e.replace(/%longitude%/g,n.lng())},p=function(){var t=""!=$(a).prop("value");return t},s=function(){var t,e=c(),n=$(a).prop("value");if(""!==n){var i=e.indexOf("%latitude%"),o=e.indexOf("%longitude%"),r=o>i,u=r?0:1,d=r?1:0,l=n.match(/-?\d+(\.\d+)?/g)[u],p=n.match(/-?\d+(\.\d+)?/g)[d];t=new google.maps.LatLng(l,p)}else t=null;return t},g=function(){var e=$(t).data("latitude"),n=$(t).data("longitude"),a=new google.maps.LatLng(e,n);return a},m=function(){var t;return t=p()?s():g()},c=function(){var e=$(t).data("pattern");return e},f=function(t){var e;if(void 0!==t.latitude&&void 0!==t.longitude){var n=t.latitude,a=t.longitude;e=new google.maps.LatLng(n,a)}else e=t;return e};this.initialize=function(){r(),u(),d()},this.getId=function(){var e=$(t).prop("id");return e},this.setPosition=function(e){if(map.marker&&map.marker.setMap(null),null===e)return void $(a).prop("disabled",!0);$(a).prop("disabled",!1);var n=f(e);1===$(t).data("align-map-center")&&map.panTo(n);var i=null;1===$(t).data("animate-marker")&&(i=google.maps.Animation.DROP),map.marker=new google.maps.Marker({map:map,position:n,draggable:!0,animation:i}),google.maps.event.addListener(map.marker,"dragend",function(){o.setPosition(this.getPosition())});var r=($(t).data("pattern"),l(n));$(a).prop("value",r),$(".latitude").val(n.H),$(".longitude").val(n.L),console.log("spostato a "+n.H+" e "+n.L)},this.panTo=function(t){var e=f(t);map.panTo(e)},this.setZoom=function(t){map.setZoom(t)}}var mapInputWidgetManager,map;$(window).load(function(){mapInputWidgetManager=new MapInputWidgetManager,mapInputWidgetManager.initializeWidgets(),$("#addresscompletion").autocomplete({messages:{noResults:"Nessun indirizzo trovato",results:function(){return""}},source:function(t,e){geocoder.geocode({address:t.term},function(t){e($.map(t,function(t){return{label:t.formatted_address,value:t.formatted_address,latitude:t.geometry.location.lat(),longitude:t.geometry.location.lng(),components:t.address_components}}))})},select:function(t,e){$("input.latitude").val(e.item.latitude),$("input.longitude").val(e.item.longitude);for(var n,a=e.item.components,i="",o="",r=0;n=a[r];r++)console.log(n),"locality"==n.types[0]&&$(".city").val(n.long_name),"route"==n.types[0]&&(o=n.short_name),"street_number"==n.types[0]&&(i=n.short_name),"country"==n.types[0]&&$(".country").val(n.long_name);$(".address").val(o+" "+i);var u=new google.maps.LatLng(e.item.latitude,e.item.longitude);currWidget.setPosition(u),map.setCenter(u),map.setZoom(16)}}),$(window).resize(function(){setTimeout(function(){google.maps.event.trigger(map,"resize")},300)})});